<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><title xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory">Chapter 3. Working with objects</title><link rel="stylesheet" href="css/hibernate.css" type="text/css"/><meta xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" name="generator" content="DocBook XSL Stylesheets V1.72.0"/><link rel="start" href="index.html" title="Hibernate EntityManager"/><link rel="up" href="index.html" title="Hibernate EntityManager"/><link rel="prev" href="configuration.html" title="Chapter 2. Setup and configuration"/><link rel="next" href="metamodel.html" title="Chapter 4. Metamodel"/></head><body><p id="title"><a href="http://www.hibernate.org" class="site_href"><strong>Hibernate.org</strong></a><a href="http://hibernate.org/Documentation/DocumentationOverview" class="doc_href"><strong>Community Documentation</strong></a></p><ul class="docnav"><li class="previous"><a accesskey="p" href="configuration.html"><strong>Prev</strong></a></li><li class="next"><a accesskey="n" href="metamodel.html"><strong>Next</strong></a></li></ul><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="objectstate"/>Chapter 3. Working with objects</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="objectstate.html#d0e1030">3.1. Entity states</a></span></dt><dt><span class="section"><a href="objectstate.html#d0e1053">3.2. Making objects persistent</a></span></dt><dt><span class="section"><a href="objectstate.html#d0e1077">3.3. Loading an object</a></span></dt><dt><span class="section"><a href="objectstate.html#d0e1104">3.4. Querying objects</a></span></dt><dd><dl><dt><span class="section"><a href="objectstate.html#d0e1109">3.4.1. Executing queries</a></span></dt></dl></dd><dt><span class="section"><a href="objectstate.html#d0e1312">3.5. Modifying persistent objects</a></span></dt><dt><span class="section"><a href="objectstate.html#d0e1324">3.6. Detaching a object</a></span></dt><dt><span class="section"><a href="objectstate.html#d0e1334">3.7. Modifying detached objects</a></span></dt><dt><span class="section"><a href="objectstate.html#d0e1356">3.8. Automatic state detection</a></span></dt><dt><span class="section"><a href="objectstate.html#d0e1430">3.9. Deleting managed objects</a></span></dt><dt><span class="section"><a href="objectstate.html#d0e1440">3.10. Flush the persistence context</a></span></dt><dd><dl><dt><span class="section"><a href="objectstate.html#d0e1445">3.10.1. In a transaction</a></span></dt><dt><span class="section"><a href="objectstate.html#d0e1522">3.10.2. Outside a transaction</a></span></dt></dl></dd><dt><span class="section"><a href="objectstate.html#objectstate-transitive">3.11. Transitive persistence</a></span></dt><dt><span class="section"><a href="objectstate.html#d0e1650">3.12. Locking</a></span></dt><dt><span class="section"><a href="objectstate.html#d0e1709">3.13. Caching</a></span></dt><dt><span class="section"><a href="objectstate.html#d0e1789">3.14. Checking the state of an object</a></span></dt><dt><span class="section"><a href="objectstate.html#d0e1815">3.15. Native Hibernate API</a></span></dt></dl></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="d0e1030"/>3.1. Entity states</h2></div></div></div><p>Like in Hibernate (comparable terms in parentheses), an entity
    instance is in one of the following states:</p><div class="itemizedlist"><ul><li><p>New (transient): an entity is new if it has just been
        instantiated using the new operator, and it is not associated with a
        persistence context. It has no persistent representation in the
        database and no identifier value has been assigned.</p></li><li><p>Managed (persistent): a managed entity instance is an instance
        with a persistent identity that is currently associated with a
        persistence context.</p></li><li><p>Detached: the entity instance is an instance with a persistent
        identity that is no longer associated with a persistence context,
        usually because the persistence context was closed or the instance was
        evicted from the context.</p></li><li><p>Removed: a removed entity instance is an instance with a
        persistent identity, associated with a persistence context, but
        scheduled for removal from the database.</p></li></ul></div><p>The <code class="classname">EntityManager</code> API allows you to change
    the state of an entity, or in other words, to load and store objects. You
    will find persistence with JPA easier to understand if you think about
    object state management, not managing of SQL statements.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="d0e1053"/>3.2. Making objects persistent</h2></div></div></div><p>Once you've created a new entity instance (using the common
    <code class="literal">new</code> operator) it is in <code class="literal">new</code> state.
    You can make it persistent by associating it to an entity manager:</p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">DomesticCat</span><!-- <br/> --><span class="java_plain">&nbsp;fritz&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_keyword">new</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">DomesticCat</span><!-- <br/> --><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">fritz</span><span class="java_separator">.</span><span class="java_plain">setColor</span><span class="java_separator">(</span><span class="java_type">Color</span><span class="java_separator">.</span><span class="java_plain">GINGER</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">fritz</span><span class="java_separator">.</span><span class="java_plain">setSex</span><span class="java_separator">(</span><span class="java_literal">'M'</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">fritz</span><span class="java_separator">.</span><span class="java_plain">setName</span><span class="java_separator">(</span><span class="java_literal">&quot;Fritz&quot;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">em</span><span class="java_separator">.</span><span class="java_plain">persist</span><span class="java_separator">(</span><span class="java_plain">fritz</span><span class="java_separator">);</span></pre><p>If the <code class="literal">DomesticCat</code> entity type has a generated
    identifier, the value is associated to the instance when
    <code class="code">persist()</code> is called. If the identifier is not automatically
    generated, the application-assigned (usually natural) key value has to be
    set on the instance before <code class="code">persist()</code> is called.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="d0e1077"/>3.3. Loading an object</h2></div></div></div><p>Load an entity instance by its identifier value with the entity
    manager's <code class="code">find()</code> method:</p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">cat&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;em</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">find</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_type">Cat</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_keyword">class</span><!-- <br/> --><span class="java_separator">,</span><!-- <br/> --><span class="java_plain">&nbsp;catId</span><!-- <br/> --><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_plain">&nbsp;</span><span class="java_type">You</span><span class="java_plain">&nbsp;may&nbsp;need&nbsp;to&nbsp;wrap&nbsp;the&nbsp;primitive&nbsp;identifiers</span>
<!--  --><br/><span class="java_type">long</span><span class="java_plain">&nbsp;catId&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">1234</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">em</span><span class="java_separator">.</span><span class="java_plain">find</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_type">Cat</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">Long</span><span class="java_separator">(</span><span class="java_plain">catId</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span></pre><p>In some cases, you don't really want to load the object state, but
    just having a reference to it (ie a proxy). You can get this reference
    using the <code class="literal">getReference()</code> method. This is especially
    useful to link a child to its parent without having to load the
    parent.</p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">child&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_keyword">new</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Child</span><!-- <br/> --><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">child</span><span class="java_separator">.</span><span class="java_type">SetName</span><span class="java_separator">(</span><span class="java_literal">&quot;Henry&quot;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_type">Parent</span><span class="java_plain">&nbsp;parent&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;em</span><span class="java_separator">.</span><span class="java_plain">getReference</span><span class="java_separator">(</span><span class="java_type">Parent</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">,</span><span class="java_plain">&nbsp;parentId</span><span class="java_separator">);</span><span class="java_plain">&nbsp;</span><span class="java_operator">//</span><span class="java_plain">no&nbsp;query&nbsp;to&nbsp;the&nbsp;DB</span>
<!--  --><br/><span class="java_plain">child</span><span class="java_separator">.</span><span class="java_plain">setParent</span><span class="java_separator">(</span><span class="java_plain">parent</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">em</span><span class="java_separator">.</span><span class="java_plain">persist</span><span class="java_separator">(</span><span class="java_plain">child</span><span class="java_separator">);</span></pre><p>You can reload an entity instance and it's collections at any time
    using the <code class="code">em.refresh()</code> operation. This is useful when
    database triggers are used to initialize some of the properties of the
    entity. Note that only the entity instance and its collections are
    refreshed unless you specify <code class="literal">REFRESH</code> as a cascade style
    of any associations:</p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">em</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">persist</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_plain">cat</span><!-- <br/> --><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">em</span><span class="java_separator">.</span><span class="java_plain">flush</span><span class="java_separator">();</span><span class="java_plain">&nbsp;</span><span class="java_operator">//</span><span class="java_plain">&nbsp;force&nbsp;the&nbsp;SQL&nbsp;insert&nbsp;and&nbsp;triggers&nbsp;to&nbsp;run</span>
<!--  --><br/><span class="java_plain">em</span><span class="java_separator">.</span><span class="java_plain">refresh</span><span class="java_separator">(</span><span class="java_plain">cat</span><span class="java_separator">);</span><span class="java_plain">&nbsp;</span><span class="java_operator">//</span><span class="java_plain">re</span><span class="java_operator">-</span><span class="java_plain">read&nbsp;the&nbsp;state&nbsp;</span><span class="java_separator">(</span><span class="java_plain">after&nbsp;the&nbsp;trigger&nbsp;executes</span><span class="java_separator">)</span></pre></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="d0e1104"/>3.4. Querying objects</h2></div></div></div><p>If you don't know the identifier values of the objects you are
    looking for, you need a query. The Hibernate EntityManager implementation
    supports an easy-to-use but powerful object-oriented query language
    (JP-QL) which has been inspired by HQL (and vice-versa). HQL is strictly
    speaking a superset of JP-QL. Both query languages are portable across
    databases, the use entity and property names as identifiers (instead of
    table and column names). You may also express your query in the native SQL
    of your database, with optional support from JPA for result set conversion
    into Java business objects.</p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="d0e1109"/>3.4.1. Executing queries</h3></div></div></div><p>JP-QL and SQL queries are represented by an instance of
      <code class="classname">javax.persistence.Query</code>. This interface offers
      methods for parameter binding, result set handling, and for execution of
      the query. Queries are always created using the current entity
      manager:</p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">List</span><!-- <br/> --><span class="java_operator">&lt;?&gt;</span><!-- <br/> --><span class="java_plain">&nbsp;cats&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;em</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">createQuery</span><!-- <br/> --><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">&quot;select&nbsp;cat&nbsp;from&nbsp;Cat&nbsp;as&nbsp;cat&nbsp;where&nbsp;cat.birthdate&nbsp;&lt;&nbsp;?1&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">setParameter</span><span class="java_separator">(</span><span class="java_literal">1</span><span class="java_separator">,</span><span class="java_plain">&nbsp;date</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">TemporalType</span><span class="java_separator">.</span><span class="java_plain">DATE</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">getResultList</span><span class="java_separator">();</span>
</span>
<!--  --><br/><span class="java_type">List</span><span class="java_operator">&lt;?&gt;</span><span class="java_plain">&nbsp;mothers&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;em</span><span class="java_separator">.</span><span class="java_plain">createQuery</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">&quot;select&nbsp;mother&nbsp;from&nbsp;Cat&nbsp;as&nbsp;cat&nbsp;join&nbsp;cat.mother&nbsp;as&nbsp;mother&nbsp;where&nbsp;cat.name&nbsp;=&nbsp;?1&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">setParameter</span><span class="java_separator">(</span><span class="java_literal">1</span><span class="java_separator">,</span><span class="java_plain">&nbsp;name</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">getResultList</span><span class="java_separator">();</span>
</span>
<!--  --><br/><span class="java_type">List</span><span class="java_operator">&lt;?&gt;</span><span class="java_plain">&nbsp;kittens&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;em</span><span class="java_separator">.</span><span class="java_plain">createQuery</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">&quot;from&nbsp;Cat&nbsp;as&nbsp;cat&nbsp;where&nbsp;cat.mother&nbsp;=&nbsp;?1&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">setEntity</span><span class="java_separator">(</span><span class="java_literal">1</span><span class="java_separator">,</span><span class="java_plain">&nbsp;pk</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">getResultList</span><span class="java_separator">();</span>
</span>
<!--  --><br/><span class="java_type">Cat</span><span class="java_plain">&nbsp;mother&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_type">Cat</span><span class="java_separator">)</span><span class="java_plain">&nbsp;em</span><span class="java_separator">.</span><span class="java_plain">createQuery</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">&quot;select&nbsp;cat.mother&nbsp;from&nbsp;Cat&nbsp;as&nbsp;cat&nbsp;where&nbsp;cat&nbsp;=&nbsp;?1&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">setParameter</span><span class="java_separator">(</span><span class="java_literal">1</span><span class="java_separator">,</span><span class="java_plain">&nbsp;izi</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">getSingleResult</span><span class="java_separator">();</span></pre><p>A query is usually executed by invoking
      <code class="methodname">getResultList()</code>. This method loads the
      resulting instances of the query completely into memory. Entity
      instances retrieved by a query are in persistent state. The
      <code class="methodname">getSingleResult() </code>method offers a shortcut if
      you know your query will only return a single object.</p><p>JPA 2 provides more type-safe approaches to queries. The truly
      type-safe approach is the Criteria API explained in <a href="querycriteria.html" title="Chapter 9. Criteria Queries">Chapter 9, <i xmlns:xlink="http://www.w3.org/1999/xlink">Criteria Queries</i></a>.</p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">CriteriaQuery</span><!-- <br/> --><span class="java_operator">&lt;</span><!-- <br/> --><span class="java_type">Cat</span><!-- <br/> --><span class="java_operator">&gt;</span><!-- <br/> --><span class="java_plain">&nbsp;criteria&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;builder</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">createQuery</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Cat</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_keyword">class</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_separator">);</span>
<!--  --><br/><span class="java_type">Root</span><span class="java_operator">&lt;</span><span class="java_type">Cat</span><span class="java_operator">&gt;</span><span class="java_plain">&nbsp;cat&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;criteria</span><span class="java_separator">.</span><span class="java_plain">from</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_type">Cat</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">criteria</span><span class="java_separator">.</span><span class="java_plain">select</span><span class="java_separator">(</span><span class="java_plain">&nbsp;cat&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">criteria</span><span class="java_separator">.</span><span class="java_plain">where</span><span class="java_separator">(</span><span class="java_plain">&nbsp;builder</span><span class="java_separator">.</span><span class="java_plain">lt</span><span class="java_separator">(</span><span class="java_plain">&nbsp;cat</span><span class="java_separator">.</span><span class="java_plain">get</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_type">Cat_</span><span class="java_separator">.</span><span class="java_plain">birthdate&nbsp;</span><span class="java_separator">),</span><span class="java_plain">&nbsp;catDate&nbsp;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_type">List</span><span class="java_operator">&lt;</span><span class="java_type">Cat</span><span class="java_operator">&gt;</span><span class="java_plain">&nbsp;cats&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;em</span><span class="java_separator">.</span><span class="java_plain">createQuery</span><span class="java_separator">(</span><span class="java_plain">&nbsp;criteria&nbsp;</span><span class="java_separator">).</span><span class="java_plain">getResultList</span><span class="java_separator">();</span><span class="java_plain">&nbsp;</span><span class="java_operator">//</span><span class="java_plain">notice&nbsp;no&nbsp;downcasting&nbsp;is&nbsp;necessary</span></pre><p>But you can benefit form some type-safe convenience even when
      using JP-QL (note that it's not as type-safe as the compiler has to
      trust you with the return type.</p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_operator">//</span><!-- <br/> --><span class="java_type">No</span><!-- <br/> --><span class="java_plain">&nbsp;downcasting&nbsp;since&nbsp;we&nbsp;pass&nbsp;the&nbsp;</span><!-- <br/> --><span class="java_keyword">return</span><!-- <br/> --><span class="java_plain">&nbsp;type</span>
<!--  --><br/><span class="java_type">List</span><span class="java_operator">&lt;</span><span class="java_type">Cat</span><span class="java_operator">&gt;</span><span class="java_plain">&nbsp;cats&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;em</span><span class="java_separator">.</span><span class="java_plain">createQuery</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">&quot;select&nbsp;cat&nbsp;from&nbsp;Cat&nbsp;as&nbsp;cat&nbsp;where&nbsp;cat.birthdate&nbsp;&lt;&nbsp;?1&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">Cat</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">setParameter</span><span class="java_separator">(</span><span class="java_literal">1</span><span class="java_separator">,</span><span class="java_plain">&nbsp;date</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">TemporalType</span><span class="java_separator">.</span><span class="java_plain">DATE</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">getResultList</span><span class="java_separator">();</span></pre><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><h2>Note</h2><p>We highly recommend the Criteria API approach. While more
        verbose, it provides compiler-enforced safety (including down to
        property names) which will pay off when the application will move to
        maintenance mode.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="d0e1140"/>3.4.1.1. Projection</h4></div></div></div><p>JPA queries can return tuples of objects if projection is used.
        Each result tuple is returned as an object array:</p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">Iterator</span><!-- <br/> --><span class="java_plain">&nbsp;kittensAndMothers&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;sess</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">createQuery</span><!-- <br/> --><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">&quot;select&nbsp;kitten,&nbsp;mother&nbsp;from&nbsp;Cat&nbsp;kitten&nbsp;join&nbsp;kitten.mother&nbsp;mother&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">getResultList</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">iterator</span><span class="java_separator">();</span>
</span>
<!--  --><br/><span class="java_keyword">while</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_plain">&nbsp;kittensAndMothers</span><span class="java_separator">.</span><span class="java_plain">hasNext</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Object</span><span class="java_separator">[]</span><span class="java_plain">&nbsp;tuple&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_type">Object</span><span class="java_separator">[])</span><span class="java_plain">&nbsp;kittensAndMothers</span><span class="java_separator">.</span><span class="java_plain">next</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Cat</span><span class="java_plain">&nbsp;kitten&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_type">Cat</span><span class="java_separator">)</span><span class="java_plain">&nbsp;tuple</span><span class="java_separator">[</span><span class="java_literal">0</span><span class="java_separator">];</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Cat</span><span class="java_plain">&nbsp;mother&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_type">Cat</span><span class="java_separator">)</span><span class="java_plain">&nbsp;tuple</span><span class="java_separator">[</span><span class="java_literal">1</span><span class="java_separator">];</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">....</span>
<!--  --><br/><span class="java_separator">}</span></pre><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><h2>Note</h2><p>The criteria API provides a type-safe approach to projection
          results. Check out <a href="querycriteria.html#querycriteria-tuple" title="9.2. Tuple criteria queries">Section 9.2, “Tuple criteria queries”</a>.</p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="d0e1152"/>3.4.1.2. Scalar results</h4></div></div></div><p>Queries may specify a particular property of an entity in the
        select clause, instead of an entity alias. You may call SQL aggregate
        functions as well. Returned non-transactional objects or aggregation
        results are considered "scalar" results and are not entities in
        persistent state (in other words, they are considered "read
        only"):</p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">Iterator</span><!-- <br/> --><span class="java_plain">&nbsp;results&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;em</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">createQuery</span><!-- <br/> --><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">&quot;select&nbsp;cat.color,&nbsp;min(cat.birthdate),&nbsp;count(cat)&nbsp;from&nbsp;Cat&nbsp;cat&nbsp;&quot;</span><span class="java_plain">&nbsp;</span><span class="java_operator">+</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">&quot;group&nbsp;by&nbsp;cat.color&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">getResultList</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">iterator</span><span class="java_separator">();</span>
</span>
<!--  --><br/><span class="java_keyword">while</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_plain">&nbsp;results</span><span class="java_separator">.</span><span class="java_plain">hasNext</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Object</span><span class="java_separator">[]</span><span class="java_plain">&nbsp;row&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;results</span><span class="java_separator">.</span><span class="java_plain">next</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Color</span><span class="java_plain">&nbsp;type&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_type">Color</span><span class="java_separator">)</span><span class="java_plain">&nbsp;row</span><span class="java_separator">[</span><span class="java_literal">0</span><span class="java_separator">];</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Date</span><span class="java_plain">&nbsp;oldest&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_type">Date</span><span class="java_separator">)</span><span class="java_plain">&nbsp;row</span><span class="java_separator">[</span><span class="java_literal">1</span><span class="java_separator">];</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Integer</span><span class="java_plain">&nbsp;count&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_type">Integer</span><span class="java_separator">)</span><span class="java_plain">&nbsp;row</span><span class="java_separator">[</span><span class="java_literal">2</span><span class="java_separator">];</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.....</span>
<!--  --><br/><span class="java_separator">}</span></pre></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="d0e1159"/>3.4.1.3. Bind parameters</h4></div></div></div><p>Both named and positional query parameters are supported, the
        <code class="literal">Query</code> API offers several methods to bind arguments.
        The JPA specification numbers positional parameters from one. Named
        parameters are identifiers of the form <code class="literal">:paramname</code>
        in the query string. Named parameters should be preferred, they are
        more robust and easier to read and understand:</p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_operator">//</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Named</span><!-- <br/> --><span class="java_plain">&nbsp;parameter&nbsp;</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_plain">preferred</span><!-- <br/> --><span class="java_separator">)</span>
<!--  --><br/><span class="java_type">Query</span><span class="java_plain">&nbsp;q&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;em</span><span class="java_separator">.</span><span class="java_plain">createQuery</span><span class="java_separator">(</span><span class="java_literal">&quot;select&nbsp;cat&nbsp;from&nbsp;DomesticCat&nbsp;cat&nbsp;where&nbsp;cat.name&nbsp;=&nbsp;:name&quot;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">q</span><span class="java_separator">.</span><span class="java_plain">setParameter</span><span class="java_separator">(</span><span class="java_literal">&quot;name&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;Fritz&quot;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_type">List</span><span class="java_plain">&nbsp;cats&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;q</span><span class="java_separator">.</span><span class="java_plain">getResultList</span><span class="java_separator">();</span>
</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_plain">&nbsp;</span><span class="java_type">Positional</span><span class="java_plain">&nbsp;parameter</span>
<!--  --><br/><span class="java_type">Query</span><span class="java_plain">&nbsp;q&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;em</span><span class="java_separator">.</span><span class="java_plain">createQuery</span><span class="java_separator">(</span><span class="java_literal">&quot;select&nbsp;cat&nbsp;from&nbsp;DomesticCat&nbsp;cat&nbsp;where&nbsp;cat.name&nbsp;=&nbsp;?1&quot;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">q</span><span class="java_separator">.</span><span class="java_plain">setParameter</span><span class="java_separator">(</span><span class="java_literal">1</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;Izi&quot;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_type">List</span><span class="java_plain">&nbsp;cats&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;q</span><span class="java_separator">.</span><span class="java_plain">getResultList</span><span class="java_separator">();</span>
</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_plain">&nbsp;</span><span class="java_type">Named</span><span class="java_plain">&nbsp;parameter&nbsp;list</span>
<!--  --><br/><span class="java_type">List</span><span class="java_plain">&nbsp;names&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">ArrayList</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">names</span><span class="java_separator">.</span><span class="java_plain">add</span><span class="java_separator">(</span><span class="java_literal">&quot;Izi&quot;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">names</span><span class="java_separator">.</span><span class="java_plain">add</span><span class="java_separator">(</span><span class="java_literal">&quot;Fritz&quot;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_type">Query</span><span class="java_plain">&nbsp;q&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;em</span><span class="java_separator">.</span><span class="java_plain">createQuery</span><span class="java_separator">(</span><span class="java_literal">&quot;select&nbsp;cat&nbsp;from&nbsp;DomesticCat&nbsp;cat&nbsp;where&nbsp;cat.name&nbsp;in&nbsp;(:namesList)&quot;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">q</span><span class="java_separator">.</span><span class="java_plain">setParameter</span><span class="java_separator">(</span><span class="java_literal">&quot;namesList&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;names</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_type">List</span><span class="java_plain">&nbsp;cats&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;q</span><span class="java_separator">.</span><span class="java_plain">list</span><span class="java_separator">();</span></pre></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="d0e1172"/>3.4.1.4. Pagination</h4></div></div></div><p>If you need to specify bounds upon your result set (the maximum
        number of rows you want to retrieve and/or the first row you want to
        retrieve), use the following methods:</p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">Query</span><!-- <br/> --><span class="java_plain">&nbsp;q&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;em</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">createQuery</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_literal">&quot;select&nbsp;cat&nbsp;from&nbsp;DomesticCat&nbsp;cat&quot;</span><!-- <br/> --><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">q</span><span class="java_separator">.</span><span class="java_plain">setFirstResult</span><span class="java_separator">(</span><span class="java_literal">20</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">q</span><span class="java_separator">.</span><span class="java_plain">setMaxResults</span><span class="java_separator">(</span><span class="java_literal">10</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_type">List</span><span class="java_plain">&nbsp;cats&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;q</span><span class="java_separator">.</span><span class="java_plain">getResultList</span><span class="java_separator">();</span><span class="java_plain">&nbsp;</span><span class="java_operator">//</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;cats&nbsp;from&nbsp;the&nbsp;</span><span class="java_literal">20</span><span class="java_plain">th&nbsp;position&nbsp;to&nbsp;</span><span class="java_literal">29</span><span class="java_plain">th</span></pre><p>Hibernate knows how to translate this limit query into the
        native SQL of your DBMS.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="d0e1181"/>3.4.1.5. Externalizing named queries</h4></div></div></div><p>You may also define named queries through annotations:</p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@javax</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">persistence</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_type">NamedQuery</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_plain">name</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_literal">&quot;eg.DomesticCat.by.name.and.minimum.weight&quot;</span><!-- <br/> --><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;query</span><span class="java_operator">=</span><span class="java_literal">&quot;select&nbsp;cat&nbsp;from&nbsp;eg.DomesticCat&nbsp;as&nbsp;cat&nbsp;&nbsp;where&nbsp;cat.name&nbsp;=&nbsp;?1&nbsp;and&nbsp;cat.weight&nbsp;&gt;&nbsp;?2&quot;</span><span class="java_separator">)</span></pre><p>Parameters are bound programmatically to the named query, before
        it is executed:</p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">Query</span><!-- <br/> --><span class="java_plain">&nbsp;q&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;em</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">createNamedQuery</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_literal">&quot;eg.DomesticCat.by.name.and.minimum.weight&quot;</span><!-- <br/> --><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">q</span><span class="java_separator">.</span><span class="java_plain">setString</span><span class="java_separator">(</span><span class="java_literal">1</span><span class="java_separator">,</span><span class="java_plain">&nbsp;name</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">q</span><span class="java_separator">.</span><span class="java_plain">setInt</span><span class="java_separator">(</span><span class="java_literal">2</span><span class="java_separator">,</span><span class="java_plain">&nbsp;minWeight</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_type">List</span><span class="java_operator">&lt;?&gt;</span><span class="java_plain">&nbsp;cats&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;q</span><span class="java_separator">.</span><span class="java_plain">getResultList</span><span class="java_separator">();</span></pre><p>You can also use the slightly more type-safe approach:</p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">Query</span><!-- <br/> --><span class="java_plain">&nbsp;q&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;em</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">createNamedQuery</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_literal">&quot;eg.DomesticCat.by.name.and.minimum.weight&quot;</span><!-- <br/> --><span class="java_separator">,</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Cat</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_keyword">class</span><!-- <br/> --><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">q</span><span class="java_separator">.</span><span class="java_plain">setString</span><span class="java_separator">(</span><span class="java_literal">1</span><span class="java_separator">,</span><span class="java_plain">&nbsp;name</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">q</span><span class="java_separator">.</span><span class="java_plain">setInt</span><span class="java_separator">(</span><span class="java_literal">2</span><span class="java_separator">,</span><span class="java_plain">&nbsp;minWeight</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_type">List</span><span class="java_operator">&lt;</span><span class="java_type">Cat</span><span class="java_operator">&gt;</span><span class="java_plain">&nbsp;cats&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;q</span><span class="java_separator">.</span><span class="java_plain">getResultList</span><span class="java_separator">();</span></pre><p>Note that the actual program code is independent of the query
        language that is used, you may also define native SQL queries in
        metadata, or use Hibernate's native facilities by placing them in XML
        mapping files.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="d0e1198"/>3.4.1.6. Native queries</h4></div></div></div><p>You may express a query in SQL, using
        <code class="methodname">createNativeQuery()</code> and let Hibernate take
        care mapping from JDBC result sets to business objects. Use the
        <code class="literal">@SqlResultSetMapping</code> (please see the Hibernate
        Annotations reference documentation on how to map a SQL resultset
        mapping) or the entity mapping (if the column names of the query
        result are the same as the names declared in the entity mapping;
        remember that all entity columns have to be returned for this
        mechanism to work):</p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">SqlResultSetMapping</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_plain">name</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_literal">&quot;getItem&quot;</span><!-- <br/> --><span class="java_separator">,</span><!-- <br/> --><span class="java_plain">&nbsp;entities&nbsp;</span><!-- <br/> --><span class="java_operator">=</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">EntityResult</span><span class="java_separator">(</span><span class="java_plain">entityClass</span><span class="java_operator">=</span><span class="java_plain">org</span><span class="java_separator">.</span><span class="java_plain">hibernate</span><span class="java_separator">.</span><span class="java_plain">ejb</span><span class="java_separator">.</span><span class="java_plain">test</span><span class="java_separator">.</span><span class="java_type">Item</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">,</span><span class="java_plain">&nbsp;fields</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">FieldResult</span><span class="java_separator">(</span><span class="java_plain">name</span><span class="java_operator">=</span><span class="java_literal">&quot;name&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;column</span><span class="java_operator">=</span><span class="java_literal">&quot;itemname&quot;</span><span class="java_separator">),</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">FieldResult</span><span class="java_separator">(</span><span class="java_plain">name</span><span class="java_operator">=</span><span class="java_literal">&quot;descr&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;column</span><span class="java_operator">=</span><span class="java_literal">&quot;itemdescription&quot;</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">})</span>
<!--  --><br/><span class="java_separator">)</span>
</span>
<!--  --><br/><span class="java_type">Query</span><span class="java_plain">&nbsp;q&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;em</span><span class="java_separator">.</span><span class="java_plain">createNativeQuery</span><span class="java_separator">(</span><span class="java_literal">&quot;select&nbsp;name&nbsp;as&nbsp;itemname,&nbsp;descr&nbsp;as&nbsp;itemdescription&nbsp;from&nbsp;Item&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;getItem&quot;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">item&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_type">Item</span><span class="java_separator">)</span><span class="java_plain">&nbsp;q</span><span class="java_separator">.</span><span class="java_plain">getSingleResult</span><span class="java_separator">();</span><span class="java_plain">&nbsp;</span><span class="java_operator">//</span><span class="java_plain">from&nbsp;a&nbsp;resultset</span>
</span>
<!--  --><br/><span class="java_type">Query</span><span class="java_plain">&nbsp;q&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;em</span><span class="java_separator">.</span><span class="java_plain">createNativeQuery</span><span class="java_separator">(</span><span class="java_literal">&quot;select&nbsp;*&nbsp;from&nbsp;Item&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">Item</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">item&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_type">Item</span><span class="java_separator">)</span><span class="java_plain">&nbsp;q</span><span class="java_separator">.</span><span class="java_plain">getSingleResult</span><span class="java_separator">();</span><span class="java_plain">&nbsp;</span><span class="java_operator">//</span><span class="java_plain">from&nbsp;a&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;columns&nbsp;names&nbsp;match&nbsp;the&nbsp;mapping</span></pre><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><h2>Note</h2><p>For more information about scalar support in named queries,
          please refers to the Hibernate Annotations documentation</p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="d0e1214"/>3.4.1.7. Query lock and flush mode</h4></div></div></div><p>You can adjust the flush mode used when executing the query as
        well as define the lock mode used to load the entities.</p><p>Adjusting the flush mode is interesting when one must guaranty
        that a query execution will not trigger a flush operation. Most of the
        time you don't need to care about this.</p><p>Adjusting the lock mode is useful if you need to lock the
        objects returns by the query to a certain level.</p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">query</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">setFlushMode</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_type">FlushModeType</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">COMMIT</span><!-- <br/> --><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">.</span><span class="java_plain">setLockMode</span><span class="java_separator">(</span><span class="java_type">LockModeType</span><span class="java_separator">.</span><span class="java_plain">PESSIMISTIC_READ</span><span class="java_separator">);</span></pre><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><h2>Note</h2><p>If you want to use <code class="literal">FlushMode.MANUAL</code> (ie the
          Hibernate specific flush mode), you will need to use a query hint.
          See below.</p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="d0e1231"/>3.4.1.8. Query hints</h4></div></div></div><p>Query hints (for performance optimization, usually) are
        implementation specific. Hints are declared using the
        <code class="methodname">query.setHint(String name, Object value)</code>
        method, or through the <code class="literal">@Named(Native)Query(hints)</code>
        annotation Note that these are not SQL query hints! The Hibernate EJB3
        implementation offers the following query hints:</p><div class="table"><a id="d0e1242"/><p class="title"><b>Table 3.1. Hibernate query hints</b></p><div class="table-contents"><table summary="Hibernate query hints" border="1"><colgroup><col/><col/></colgroup><thead><tr><th align="center">Hint</th><th align="center">Description</th></tr></thead><tbody><tr><td>org.hibernate.timeout</td><td>Query timeout in seconds ( eg. new Integer(10)
                )</td></tr><tr><td>org.hibernate.fetchSize</td><td>Number of rows fetched by the JDBC driver per roundtrip
                ( eg. new Integer(50) )</td></tr><tr><td>org.hibernate.comment</td><td>Add a comment to the SQL query, useful for the DBA (
                e.g. new String("fetch all orders in 1 statement") )</td></tr><tr><td>org.hibernate.cacheable</td><td>Whether or not a query is cacheable ( eg. new
                Boolean(true) ), defaults to false</td></tr><tr><td>org.hibernate.cacheMode</td><td>Override the cache mode for this query ( eg.
                CacheMode.REFRESH )</td></tr><tr><td>org.hibernate.cacheRegion</td><td>Cache region of this query ( eg. new
                String("regionName") )</td></tr><tr><td>org.hibernate.readOnly</td><td>Entities retrieved by this query will be loaded in a
                read-only mode where Hibernate will never dirty-check them or
                make changes persistent ( eg. new Boolean(true) ), default to
                false</td></tr><tr><td>org.hibernate.flushMode</td><td>Flush mode used for this query (useful to pass
                Hibernate specific flush modes, in particular
                <code class="literal">MANUAL</code>).</td></tr><tr><td>org.hibernate.cacheMode</td><td>Cache mode used for this query</td></tr></tbody></table></div></div><br class="table-break"/><p>The value object accept both the native type or its string
        equivalent (eg. <code class="literal">CaheMode.REFRESH</code> or
        “<span class="quote"><code class="literal">REFRESH</code></span>”). Please refer to the
        Hibernate reference documentation for more information.</p></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="d0e1312"/>3.5. Modifying persistent objects</h2></div></div></div><p>Transactional managed instances (ie. objects loaded, saved, created
    or queried by the entity manager) may be manipulated by the application
    and any changes to persistent state will be persisted when the Entity
    manager is flushed (discussed later in this chapter). There is no need to
    call a particular method to make your modifications persistent. A
    straightforward way to update the state of an entity instance is to
    <code class="methodname">find()</code> it, and then manipulate it directly, while
    the persistence context is open:</p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">Cat</span><!-- <br/> --><span class="java_plain">&nbsp;cat&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;em</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">find</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Cat</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_keyword">class</span><!-- <br/> --><span class="java_separator">,</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_keyword">new</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Long</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_literal">69</span><!-- <br/> --><span class="java_separator">)</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">cat</span><span class="java_separator">.</span><span class="java_plain">setName</span><span class="java_separator">(</span><span class="java_literal">&quot;PK&quot;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">em</span><span class="java_separator">.</span><span class="java_plain">flush</span><span class="java_separator">();</span><span class="java_plain">&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_plain">&nbsp;changes&nbsp;to&nbsp;cat&nbsp;are&nbsp;automatically&nbsp;detected&nbsp;and&nbsp;persisted</span></pre><p>Sometimes this programming model is inefficient since it would
    require both an SQL SELECT (to load an object) and an SQL UPDATE (to
    persist its updated state) in the same session. Therefore Hibernate offers
    an alternate approach, using detached instances.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="d0e1324"/>3.6. Detaching a object</h2></div></div></div><p>An object when loaded in the persistence context is managed by
    Hibernate. You can force an object to be detached (ie. no longer managed
    by Hibernate) by closing the EntityManager or in a more fine-grained
    approach by calling the <code class="methodname">detach()</code> method.</p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">Cat</span><!-- <br/> --><span class="java_plain">&nbsp;cat&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;em</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">find</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Cat</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_keyword">class</span><!-- <br/> --><span class="java_separator">,</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_keyword">new</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Long</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_literal">69</span><!-- <br/> --><span class="java_separator">)</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_separator">);</span>
<!--  --><br/><span class="java_separator">...</span>
<!--  --><br/><span class="java_plain">em</span><span class="java_separator">.</span><span class="java_plain">detach</span><span class="java_separator">(</span><span class="java_plain">cat</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">cat</span><span class="java_separator">.</span><span class="java_plain">setName</span><span class="java_separator">(</span><span class="java_literal">&quot;New&nbsp;name&quot;</span><span class="java_separator">);</span><span class="java_plain">&nbsp;</span><span class="java_operator">//</span><span class="java_plain">not&nbsp;propatated&nbsp;to&nbsp;the&nbsp;database</span></pre></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="d0e1334"/>3.7. Modifying detached objects</h2></div></div></div><p>Many applications need to retrieve an object in one transaction,
    send it to the presentation layer for manipulation, and later save the
    changes in a new transaction. There can be significant user think and
    waiting time between both transactions. Applications that use this kind of
    approach in a high-concurrency environment usually use versioned data to
    ensure isolation for the "long" unit of work.</p><p>The JPA specifications supports this development model by providing
    for persistence of modifications made to detached instances using the
    <code class="methodname">EntityManager.merge()</code> method:</p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_operator">//</span><!-- <br/> --><span class="java_plain">&nbsp;in&nbsp;the&nbsp;first&nbsp;entity&nbsp;manager</span>
<!--  --><br/><span class="java_type">Cat</span><span class="java_plain">&nbsp;cat&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;firstEntityManager</span><span class="java_separator">.</span><span class="java_plain">find</span><span class="java_separator">(</span><span class="java_type">Cat</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">,</span><span class="java_plain">&nbsp;catId</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_type">Cat</span><span class="java_plain">&nbsp;potentialMate&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">Cat</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">firstEntityManager</span><span class="java_separator">.</span><span class="java_plain">persist</span><span class="java_separator">(</span><span class="java_plain">potentialMate</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_plain">&nbsp;in&nbsp;a&nbsp;higher&nbsp;layer&nbsp;of&nbsp;the&nbsp;application</span>
<!--  --><br/><span class="java_plain">cat</span><span class="java_separator">.</span><span class="java_plain">setMate</span><span class="java_separator">(</span><span class="java_plain">potentialMate</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_plain">&nbsp;later</span><span class="java_separator">,</span><span class="java_plain">&nbsp;in&nbsp;a&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;entity&nbsp;manager</span>
<!--  --><br/><span class="java_plain">secondEntityManager</span><span class="java_separator">.</span><span class="java_plain">merge</span><span class="java_separator">(</span><span class="java_plain">cat</span><span class="java_separator">);</span><span class="java_plain">&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_plain">&nbsp;update&nbsp;cat</span>
<!--  --><br/><span class="java_plain">secondEntityManager</span><span class="java_separator">.</span><span class="java_plain">merge</span><span class="java_separator">(</span><span class="java_plain">mate</span><span class="java_separator">);</span><span class="java_plain">&nbsp;</span><span class="java_operator">//</span><span class="java_plain">&nbsp;update&nbsp;mate</span></pre><p>The <code class="literal">merge()</code> method merges modifications made to
    the detached instance into the corresponding managed instance, if any,
    without consideration of the state of the persistence context. In other
    words, the merged objects state overrides the persistent entity state in
    the persistence context, if one is already present. The application should
    individually <code class="methodname">merge()</code> detached instances reachable
    from the given detached instance if and only if it wants their state also
    to be persistent. This can be cascaded to associated entities and
    collections, using transitive persistence, see <a href="objectstate.html#objectstate-transitive" title="3.11. Transitive persistence">Transitive persistence</a>.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="d0e1356"/>3.8. Automatic state detection</h2></div></div></div><p>The merge operation is clever enough to automatically detect whether
    the merging of the detached instance has to result in an insert or update.
    In other words, you don't have to worry about passing a new instance (and
    not a detached instance) to <code class="literal">merge()</code>, the entity manager
    will figure this out for you:</p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_operator">//</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">In</span><!-- <br/> --><span class="java_plain">&nbsp;the&nbsp;first&nbsp;entity&nbsp;manager</span>
<!--  --><br/><span class="java_type">Cat</span><span class="java_plain">&nbsp;cat&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;firstEntityManager</span><span class="java_separator">.</span><span class="java_plain">find</span><span class="java_separator">(</span><span class="java_type">Cat</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">,</span><span class="java_plain">&nbsp;catID</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_plain">&nbsp;</span><span class="java_type">In</span><span class="java_plain">&nbsp;a&nbsp;higher&nbsp;layer&nbsp;of&nbsp;the&nbsp;application</span><span class="java_separator">,</span><span class="java_plain">&nbsp;detached</span>
<!--  --><br/><span class="java_type">Cat</span><span class="java_plain">&nbsp;mate&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">Cat</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">cat</span><span class="java_separator">.</span><span class="java_plain">setMate</span><span class="java_separator">(</span><span class="java_plain">mate</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_plain">&nbsp;</span><span class="java_type">Later</span><span class="java_separator">,</span><span class="java_plain">&nbsp;in&nbsp;a&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;entity&nbsp;manager</span>
<!--  --><br/><span class="java_plain">secondEntityManager</span><span class="java_separator">.</span><span class="java_plain">merge</span><span class="java_separator">(</span><span class="java_plain">cat</span><span class="java_separator">);</span><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_plain">&nbsp;update&nbsp;existing&nbsp;state</span>
<!--  --><br/><span class="java_plain">secondEntityManager</span><span class="java_separator">.</span><span class="java_plain">merge</span><span class="java_separator">(</span><span class="java_plain">mate</span><span class="java_separator">);</span><span class="java_plain">&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_plain">&nbsp;save&nbsp;the&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;instance</span></pre><p>The usage and semantics of <code class="literal">merge()</code> seems to be
    confusing for new users. Firstly, as long as you are not trying to use
    object state loaded in one entity manager in another new entity manager,
    you should not need to use <code class="methodname">merge()</code> at all. Some
    whole applications will never use this method.</p><p>Usually <code class="methodname">merge()</code> is used in the following
    scenario:</p><div class="itemizedlist"><ul><li><p>the application loads an object in the first entity
        manager</p></li><li><p>the object is passed up to the presentation layer</p></li><li><p>some modifications are made to the object</p></li><li><p>the object is passed back down to the business logic
        layer</p></li><li><p>the application persists these modifications by calling
        <code class="methodname">merge()</code> in a second entity manager</p></li></ul></div><p>Here is the exact semantic of
    <code class="methodname">merge()</code>:</p><div class="itemizedlist"><ul><li><p>if there is a managed instance with the same identifier
        currently associated with the persistence context, copy the state of
        the given object onto the managed instance</p></li><li><p>if there is no managed instance currently associated with the
        persistence context, try to load it from the database, or create a new
        managed instance</p></li><li><p>the managed instance is returned</p></li><li><p>the given instance does not become associated with the
        persistence context, it remains detached and is usually
        discarded</p></li></ul></div><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><h2>Merging vs. saveOrUpdate/saveOrUpdateCopy</h2><p>Merging in JPA is similar to the
      <code class="literal">saveOrUpdateCopy()</code> method in native Hibernate.
      However, it is not the same as the <code class="literal">saveOrUpdate()</code>
      method, the given instance is not reattached with the persistence
      context, but a managed instance is returned by the
      <code class="methodname">merge()</code> method.</p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="d0e1430"/>3.9. Deleting managed objects</h2></div></div></div><p><code class="methodname">EntityManager.remove()</code> will remove an
    objects state from the database. Of course, your application might still
    hold a reference to a deleted object. You can think of
    <code class="methodname">remove()</code> as making a persistent instance new (aka
    transient) again. It is not detached, and a merge would result in an
    insertion.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="d0e1440"/>3.10. Flush the persistence context</h2></div></div></div><p>From time to time the entity manager will execute the SQL DML
    statements needed to synchronize the data store with the state of objects
    held in memory. This process is called flushing.</p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="d0e1445"/>3.10.1. In a transaction</h3></div></div></div><p>Flush occurs by default (this is Hibernate specific and not
      defined by the specification) at the following points:</p><div class="itemizedlist"><ul><li><p>before query execution*</p></li><li><p>from
          <code class="methodname">javax.persistence.EntityTransaction.commit()*</code></p></li><li><p>when <code class="methodname">EntityManager.flush()</code> is
          called*</p></li></ul></div><p>(*) if a transaction is active</p><p>The SQL statements are issued in the following order</p><div class="itemizedlist"><ul><li><p>all entity insertions, in the same order the corresponding
          objects were saved using
          <code class="methodname">EntityManager.persist()</code></p></li><li><p>all entity updates</p></li><li><p>all collection deletions</p></li><li><p>all collection element deletions, updates and
          insertions</p></li><li><p>all collection insertions</p></li><li><p>all entity deletions, in the same order the corresponding
          objects were deleted using
          <code class="methodname">EntityManager.remove()</code></p></li></ul></div><p>(Exception: entity instances using application-assigned
      identifiers are inserted when they are saved.)</p><p>Except when you explicitly <code class="methodname">flush()</code>, there
      are no guarantees about when the entity manager executes the JDBC calls,
      only the order in which they are executed. However, Hibernate does
      guarantee that the
      <code class="methodname">Query.getResultList()</code>/<code class="methodname">Query.getSingleResult()</code>
      will never return stale data; nor will they return wrong data if
      executed in an active transaction.</p><p>It is possible to change the default behavior so that flush occurs
      less frequently. The <code class="classname">FlushModeType</code> for an entity
      manager defines two different modes: only flush at commit time or flush
      automatically using the explained routine unless
      <code class="methodname">flush()</code> is called explicitly.</p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">em&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;emf</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">createEntityManager</span><!-- <br/> --><span class="java_separator">();</span>
<!--  --><br/><span class="java_type">Transaction</span><span class="java_plain">&nbsp;tx&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;em</span><span class="java_separator">.</span><span class="java_plain">getTransaction</span><span class="java_separator">().</span><span class="java_plain">begin</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">em</span><span class="java_separator">.</span><span class="java_plain">setFlushMode</span><span class="java_separator">(</span><span class="java_type">FlushModeType</span><span class="java_separator">.</span><span class="java_plain">COMMIT</span><span class="java_separator">);</span><span class="java_plain">&nbsp;</span><span class="java_operator">//</span><span class="java_plain">&nbsp;allow&nbsp;queries&nbsp;to&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;stale&nbsp;state</span>
</span>
<!--  --><br/><span class="java_type">Cat</span><span class="java_plain">&nbsp;izi&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;em</span><span class="java_separator">.</span><span class="java_plain">find</span><span class="java_separator">(</span><span class="java_type">Cat</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">,</span><span class="java_plain">&nbsp;id</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">izi</span><span class="java_separator">.</span><span class="java_plain">setName</span><span class="java_separator">(</span><span class="java_plain">iznizi</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_plain">&nbsp;might&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;stale&nbsp;data</span>
<!--  --><br/><span class="java_plain">em</span><span class="java_separator">.</span><span class="java_plain">createQuery</span><span class="java_separator">(</span><span class="java_literal">&quot;from&nbsp;Cat&nbsp;as&nbsp;cat&nbsp;left&nbsp;outer&nbsp;join&nbsp;cat.kittens&nbsp;kitten&quot;</span><span class="java_separator">).</span><span class="java_plain">getResultList</span><span class="java_separator">();</span>
</span>
<!--  --><br/><span class="java_operator">//</span><span class="java_plain">&nbsp;change&nbsp;to&nbsp;izi&nbsp;is&nbsp;not&nbsp;flushed</span><span class="java_operator">!</span>
<!--  --><br/><span class="java_separator">...</span>
<!--  --><br/><span class="java_plain">em</span><span class="java_separator">.</span><span class="java_plain">getTransaction</span><span class="java_separator">().</span><span class="java_plain">commit</span><span class="java_separator">();</span><span class="java_plain">&nbsp;</span><span class="java_operator">//</span><span class="java_plain">&nbsp;flush&nbsp;occurs</span></pre><p>During flush, an exception might happen (e.g. if a DML operation
      violates a constraint). TODO: Add link to exception handling.</p><p>Hibernate provides more flush modes than the one described in the
      JPA specification. In particular <code class="literal">FlushMode.MANUAL</code> for
      long running conversation. Please refer to the Hibernate core reference
      documentation for more informations.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="d0e1522"/>3.10.2. Outside a transaction</h3></div></div></div><p>In an <code class="literal">EXTENDED</code> persistence context, all read
      only operations of the entity manager can be executed outside a
      transaction (<code class="literal">find()</code>,
      <code class="literal">getReference()</code>, <code class="literal">refresh()</code>, and
      read queries). Some modifications operations can be executed outside a
      transaction, but they are queued until the persistence context join a
      transaction. This is the case of <code class="literal">persist()</code>,
      <code class="literal"><code class="literal">merge()</code></code>,
      <code class="literal">remove()</code>. Some operations cannot be called outside a
      transaction: <code class="literal">flush()</code>, <code class="literal">lock()</code>, and
      update/delete queries.</p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="objectstate-transitive"/>3.11. Transitive persistence</h2></div></div></div><p>It is quite cumbersome to save, delete, or reattach individual
    objects, especially if you deal with a graph of associated objects. A
    common case is a parent/child relationship. Consider the following
    example:</p><p>If the children in a parent/child relationship would be value typed
    (e.g. a collection of addresses or strings), their lifecycle would depend
    on the parent and no further action would be required for convenient
    "cascading" of state changes. When the parent is persisted, the
    value-typed child objects are persisted as well, when the parent is
    removed, the children will be removed, etc. This even works for operations
    such as the removal of a child from the collection; Hibernate will detect
    this and, since value-typed objects can't have shared references, remove
    the child from the database.</p><p>Now consider the same scenario with parent and child objects being
    entities, not value-types (e.g. categories and items, or parent and child
    cats). Entities have their own lifecycle, support shared references (so
    removing an entity from the collection does not mean it can be deleted),
    and there is by default no cascading of state from one entity to any other
    associated entities. The EJB3 specification does not require persistence
    by reachability. It supports a more flexible model of transitive
    persistence, as first seen in Hibernate.</p><p>For each basic operation of the entity manager - including
    <code class="methodname">persist()</code>, <code class="methodname">merge()</code>,
    <code class="methodname">remove()</code>, <code class="methodname">refresh()</code> -
    there is a corresponding cascade style. Respectively, the cascade styles
    are named <code class="literal">PERSIST</code>, <code class="literal">MERGE</code>,
    <code class="literal">REMOVE</code>, <code class="literal">REFRESH</code>,
    <code class="literal">DETACH</code>. If you want an operation to be cascaded to
    associated entity (or collection of entities), you must indicate that in
    the association annotation:</p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">OneToOne</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_plain">cascade</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_type">CascadeType</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">PERSIST</span><!-- <br/> --><span class="java_separator">)</span></pre><p>Cascading options can be combined:</p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">OneToOne</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_plain">cascade</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_separator">{</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">CascadeType</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">PERSIST</span><!-- <br/> --><span class="java_separator">,</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">CascadeType</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">REMOVE</span><!-- <br/> --><span class="java_separator">,</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">CascadeType</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">REFRESH&nbsp;</span><!-- <br/> --><span class="java_separator">}</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_separator">)</span></pre><p>You may even use <code class="literal">CascadeType.ALL</code> to specify that
    all operations should be cascaded for a particular association. Remember
    that by default, no operation is cascaded.</p><p>There is an additional cascading mode used to describe orphan
    deletion (ie an object no longer linked to an owning object should be
    removed automatically by Hibernate. Use
    <code class="literal">orphanRemoval=true</code> on <code class="classname">@OneToOne</code>
    or <code class="classname">@OneToMany</code>. Check Hibernate Annotations's
    documentation for more information.</p><p>Hibernate offers more native cascading options, please refer to the
    Hibernate Annotations manual and the Hibernate reference guide for more
    informations.</p><p>Recommendations:</p><div class="itemizedlist"><ul><li><p>It doesn't usually make sense to enable cascade on a
        <code class="literal">@ManyToOne</code> or <code class="literal">@ManyToMany</code>
        association. Cascade is often useful for <code class="literal">@OneToOne</code>
        and <code class="literal">@OneToMany</code> associations.</p></li><li><p>If the child object's lifespan is bounded by the lifespan of the
        parent object, make the parent a full lifecycle object by specifying
        <code class="literal">CascadeType.ALL</code> and
        <code class="literal">org.hibernate.annotations.CascadeType.DELETE_ORPHAN</code>
        (please refer to the Hibernate reference guide for the semantics of
        orphan delete)</p></li><li><p>Otherwise, you might not need cascade at all. But if you think
        that you will often be working with the parent and children together
        in the same transaction, and you want to save yourself some typing,
        consider using <code class="code">cascade={PERSIST, MERGE}</code>. These options
        can even make sense for a many-to-many association.</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="d0e1650"/>3.12. Locking</h2></div></div></div><p>You can define various levels of locking strategies. A lock can be
    applied in several ways:</p><div class="itemizedlist"><ul><li><p>via the explicit <code class="methodname">entityManager.lock()</code>
        method</p></li><li><p>via lookup methods on <code class="classname">EntityManager</code>:
        <code class="literal">find()</code>, <code class="literal">refresh()</code></p></li><li><p>on queries: <code class="methodname">query.setLockMode()</code></p></li></ul></div><p>You can use various lock approaches:</p><div class="itemizedlist"><ul><li><p><code class="literal">OPTIMISTIC</code> (previously
        <code class="literal">READ</code>): use an optimistic locking scheme where the
        version number is compared: the version number is compared and has to
        match before the transaction is committed.</p></li><li><p><code class="literal">OPTIMISTIC_FORCE_INCREMENT</code> (previously
        <code class="literal">WRITE</code>): use an optimistic locking scheme but force
        a version number increase as well: the version number is compared and
        has to match before the transaction is committed.</p></li><li><p><code class="literal">PESSIMISTIC_READ</code>: apply a database-level read
        lock when the lock operation is requested: roughly concurrent readers
        are allowed but no writer is allowed.</p></li><li><p><code class="literal">PESSIMISTIC_WRITE</code>: apply a database-level
        write lock when the lock operation is requested: roughly no reader nor
        writer is allowed.</p></li></ul></div><p>All these locks prevent dirty reads and non-repeatable reads on a
    given entity. Optimistic locks enforce the lock as late as possible hoping
    nobody changes the data underneath while pessimistic locks enforce the
    lock right away and keep it till the transaction is committed.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="d0e1709"/>3.13. Caching</h2></div></div></div><p>When the second-level cache is activated (see <a href="configuration.html#setup-configuration-packaging" title="2.2.1. Packaging">Section 2.2.1, “Packaging”</a> and the Hibernate Annotations
    reference documentation), Hibernate ensures it is used and properly
    updated. You can however adjust these settings by passing two
    properties:</p><div class="itemizedlist"><ul><li><p><code class="literal">javax.persistence.cache.retrieveMode</code> which
        accepts <code class="literal"><code class="classname">CacheRetrieveMode</code></code>
        values</p></li><li><p><code class="literal">javax.persistence.cache.storeMode</code> which
        accepts <code class="classname">CacheStoreMode</code> values</p></li></ul></div><p><code class="classname">CacheRetrieveMode</code> controls how Hibernate
    accesses information from the second-level cache: <code class="literal">USE</code>
    which is the default or <code class="literal">BYPASS</code> which means ignore the
    cache. <code class="classname">CacheStoreMode</code> controls how Hibernate pushes
    information to the second-level cache: <code class="literal">USE</code> which is the
    default and push data in the cache when reading from and writing to the
    database, <code class="literal">BYPASS</code> which does not insert new data in the
    cache (but can invalidate obsolete data) and
    <code class="classname">REFRESH</code> which does like default but also force data
    to be pushed to the cache on database read even if the data is already
    cached.</p><p>You can set these properties:</p><div class="itemizedlist"><ul><li><p>on a particular <code class="classname">EntityManager</code> via the
        <code class="methodname">setProperty</code> method</p></li><li><p>on a query via a query hint (<code class="methodname">setHint</code>
        method)</p></li><li><p>when calling <code class="methodname">find()</code> and
        <code class="methodname">refresh()</code> and passing the properties in the
        appropriate <code class="classname">Map</code></p></li></ul></div><p>JPA also introduces an API to interrogate the second-level cache and
    evict data manually.</p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">Cache</span><!-- <br/> --><span class="java_plain">&nbsp;cache&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;entityManagerFactory</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">getCache</span><!-- <br/> --><span class="java_separator">();</span>
</span>
<!--  --><br/><span class="java_keyword">if</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_plain">&nbsp;cache</span><span class="java_separator">.</span><span class="java_plain">contains</span><span class="java_separator">(</span><span class="java_type">User</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">,</span><span class="java_plain">&nbsp;userId</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_plain">load&nbsp;it&nbsp;as&nbsp;we&nbsp;don't&nbsp;hit&nbsp;the&nbsp;DB</span>
<!--  --><br/><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">cache</span><span class="java_separator">.</span><span class="java_plain">evict</span><span class="java_separator">(</span><span class="java_type">User</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">,</span><span class="java_plain">&nbsp;userId</span><span class="java_separator">);</span><span class="java_plain">&nbsp;</span><span class="java_operator">//</span><span class="java_plain">manually&nbsp;evict&nbsp;user&nbsp;form&nbsp;the&nbsp;second</span><span class="java_operator">-</span><span class="java_plain">level&nbsp;cache</span>
<!--  --><br/><span class="java_plain">cache</span><span class="java_separator">.</span><span class="java_plain">evict</span><span class="java_separator">(</span><span class="java_type">User</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">);</span><span class="java_plain">&nbsp;</span><span class="java_operator">//</span><span class="java_plain">evict&nbsp;all&nbsp;users&nbsp;from&nbsp;the&nbsp;second</span><span class="java_operator">-</span><span class="java_plain">level&nbsp;cache</span>
<!--  --><br/><span class="java_plain">cache</span><span class="java_separator">.</span><span class="java_plain">evictAll</span><span class="java_separator">();</span><span class="java_plain">&nbsp;</span><span class="java_operator">//</span><span class="java_plain">purge&nbsp;the&nbsp;second</span><span class="java_operator">-</span><span class="java_plain">level&nbsp;cache&nbsp;entirely</span></pre></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="d0e1789"/>3.14. Checking the state of an object</h2></div></div></div><p>You can check whether an object is managed by the persistence
    context</p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">entityManager</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">get</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_type">Cat</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_keyword">class</span><!-- <br/> --><span class="java_separator">,</span><!-- <br/> --><span class="java_plain">&nbsp;catId</span><!-- <br/> --><span class="java_separator">);</span>
<!--  --><br/><span class="java_separator">...</span>
<!--  --><br/><span class="java_type">boolean</span><span class="java_plain">&nbsp;isIn&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;entityManager</span><span class="java_separator">.</span><span class="java_plain">contains</span><span class="java_separator">(</span><span class="java_plain">cat</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_keyword">assert</span><span class="java_plain">&nbsp;isIn</span><span class="java_separator">;</span></pre><p>You can also check whether an object, an association or a property
    is lazy or not. You can do that independently of the underlying
    persistence provider: </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">PersistenceUtil</span><!-- <br/> --><span class="java_plain">&nbsp;jpaUtil&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Persistence</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">getPersistenceUtil</span><!-- <br/> --><span class="java_separator">();</span>
<!--  --><br/><span class="java_keyword">if</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_plain">&nbsp;jpaUtil</span><span class="java_separator">.</span><span class="java_plain">isLoaded</span><span class="java_separator">(</span><span class="java_plain">&nbsp;customer</span><span class="java_separator">.</span><span class="java_plain">getAddress</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_plain">display&nbsp;address&nbsp;</span><span class="java_keyword">if</span><span class="java_plain">&nbsp;loaded</span>
<!--  --><br/><span class="java_separator">}</span>
<!--  --><br/><span class="java_keyword">if</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_plain">&nbsp;jpaUtil</span><span class="java_separator">.</span><span class="java_plain">isLoaded</span><span class="java_separator">(</span><span class="java_plain">&nbsp;customer</span><span class="java_separator">.</span><span class="java_plain">getOrders&nbsp;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_plain">display&nbsp;orders&nbsp;</span><span class="java_keyword">if</span><span class="java_plain">&nbsp;loaded</span>
<!--  --><br/><span class="java_separator">}</span>
<!--  --><br/><span class="java_keyword">if</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_plain">jpaUtil</span><span class="java_separator">.</span><span class="java_plain">isLoaded</span><span class="java_separator">(</span><span class="java_plain">customer</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;detailedBio&quot;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_plain">display&nbsp;property&nbsp;detailedBio&nbsp;</span><span class="java_keyword">if</span><span class="java_plain">&nbsp;loaded</span>
<!--  --><br/><span class="java_separator">}</span></pre><p>However, if you have access to the entityManagerFactory, we
    recommend you to use:</p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">PersistenceUnitUtil</span><!-- <br/> --><span class="java_plain">&nbsp;jpaUtil&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;entityManager</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">getEntityManagerFactory</span><!-- <br/> --><span class="java_separator">().</span><!-- <br/> --><span class="java_plain">getPersistenceUnitUtil</span><!-- <br/> --><span class="java_separator">();</span>
</span>
<!--  --><br/><span class="java_type">Customer</span><span class="java_plain">&nbsp;customer&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;entityManager</span><span class="java_separator">.</span><span class="java_plain">get</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_type">Customer</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">,</span><span class="java_plain">&nbsp;customerId&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_keyword">if</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_plain">&nbsp;jpaUtil</span><span class="java_separator">.</span><span class="java_plain">isLoaded</span><span class="java_separator">(</span><span class="java_plain">&nbsp;customer</span><span class="java_separator">.</span><span class="java_plain">getAddress</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_plain">display&nbsp;address&nbsp;</span><span class="java_keyword">if</span><span class="java_plain">&nbsp;loaded</span>
<!--  --><br/><span class="java_separator">}</span>
<!--  --><br/><span class="java_keyword">if</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_plain">&nbsp;jpaUtil</span><span class="java_separator">.</span><span class="java_plain">isLoaded</span><span class="java_separator">(</span><span class="java_plain">&nbsp;customer</span><span class="java_separator">.</span><span class="java_plain">getOrders&nbsp;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_plain">display&nbsp;orders&nbsp;</span><span class="java_keyword">if</span><span class="java_plain">&nbsp;loaded</span>
<!--  --><br/><span class="java_separator">}</span>
<!--  --><br/><span class="java_keyword">if</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_plain">jpaUtil</span><span class="java_separator">.</span><span class="java_plain">isLoaded</span><span class="java_separator">(</span><span class="java_plain">customer</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;detailedBio&quot;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_plain">display&nbsp;property&nbsp;detailedBio&nbsp;</span><span class="java_keyword">if</span><span class="java_plain">&nbsp;loaded</span>
<!--  --><br/><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">log</span><span class="java_separator">.</span><span class="java_plain">debug</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;Customer&nbsp;id&nbsp;{}&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;jpaUtil</span><span class="java_separator">.</span><span class="java_plain">getIdentifier</span><span class="java_separator">(</span><span class="java_plain">customer</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span></pre><p>The performances are likely to be slightly better and you can get
    the identifier value from an object (using
    <code class="methodname">getIdentifier()</code>).</p><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><h2>Note</h2><p>These are roughly the counterpart methods of
      <code class="methodname">Hibernate.isInitialize</code>.</p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="d0e1815"/>3.15. Native Hibernate API</h2></div></div></div><p>You can always fall back to the underlying
    <code class="classname">Session</code> API from a given
    <code class="classname">EntityManager</code>:</p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">Session</span><!-- <br/> --><span class="java_plain">&nbsp;session&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;entityManager</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">unwrap</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_type">Session</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_keyword">class</span><!-- <br/> --><span class="java_separator">);</span></pre></div></div><HR xmlns=""/><a xmlns="" href=""><p xmlns="http://www.w3.org/1999/xhtml" class="copyright">Copyright © 2005 Red Hat Inc. and the various authors</p></a><ul class="docnav"><li class="previous"><a accesskey="p" href="configuration.html"><strong>Prev</strong>Chapter 2. Setup and configuration</a></li><li class="up"><a accesskey="u" href="#"><strong>Top of page</strong></a></li><li class="home"><a accesskey="h" href="index.html"><strong>Front page</strong></a></li><li class="next"><a accesskey="n" href="metamodel.html"><strong>Next</strong>Chapter 4. Metamodel</a></li></ul></body></html>